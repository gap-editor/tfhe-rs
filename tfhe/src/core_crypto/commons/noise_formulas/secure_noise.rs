// This file was autogenerated, do not modify by hand.
use crate::core_crypto::commons::dispersion::Variance;
use crate::core_crypto::commons::parameters::*;

pub fn minimal_glwe_variance_for_132_bits_security_gaussian(
    glwe_dimension: GlweDimension,
    polynomial_size: PolynomialSize,
    modulus: f64,
) -> Variance {
    let lwe_dimension = glwe_dimension.to_equivalent_lwe_dimension(polynomial_size);
    minimal_lwe_variance_for_132_bits_security_gaussian(lwe_dimension, modulus)
}

pub fn minimal_lwe_variance_for_132_bits_security_gaussian(
    lwe_dimension: LweDimension,
    modulus: f64,
) -> Variance {
    Variance(minimal_variance_for_132_bits_security_gaussian_impl(
        lwe_dimension.0 as f64,
        modulus,
    ))
}

pub fn minimal_variance_for_132_bits_security_gaussian_impl(
    lwe_dimension: f64,
    modulus: f64,
) -> f64 {
    (4.0 - 2.88539008177793 * modulus.ln()).exp2()
        + (5.31469187675068 - 0.0497829131652661 * lwe_dimension).exp2()
}

pub fn minimal_glwe_variance_for_132_bits_security_tuniform(
    glwe_dimension: GlweDimension,
    polynomial_size: PolynomialSize,
    modulus: f64,
) -> Variance {
    let lwe_dimension = glwe_dimension.to_equivalent_lwe_dimension(polynomial_size);
    minimal_lwe_variance_for_132_bits_security_tuniform(lwe_dimension, modulus)
}

pub fn minimal_lwe_variance_for_132_bits_security_tuniform(
    lwe_dimension: LweDimension,
    modulus: f64,
) -> Variance {
    Variance(minimal_variance_for_132_bits_security_tuniform_impl(
        lwe_dimension.0 as f64,
        modulus,
    ))
}

pub fn minimal_variance_for_132_bits_security_tuniform_impl(
    lwe_dimension: f64,
    modulus: f64,
) -> f64 {
    (4.0 - 2.88539008177793 * modulus.ln()).exp2()
        + (7.31469187675068 - 0.0497829131652661 * lwe_dimension).exp2()
}

pub fn variance_to_tuniform_bound_log2(variance: Variance, modulus: f64) -> u32 {
    // ceil(log2(6 * (q * lwe_stddev) ** 2 - 1) / 2 - 1 / 2)
    f64::ceil(f64::log2(6.0f64 * modulus.powi(2) * variance.0 - 1.0f64) / 2.0f64 - 0.5f64) as u32
}
